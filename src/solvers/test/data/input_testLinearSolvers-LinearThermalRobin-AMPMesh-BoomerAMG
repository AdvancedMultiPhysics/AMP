
Mesh{
  MeshName = "cube"
  MeshType = "AMP"
  dim      = 3
  Generator = "cube"
  Size = 16,16,16
  Range = 0, 1, 0, 1, 0, 1
}

NeutronicsOperator{
  name="NeutronicsSourceOperator"
  type               = "Power"
  OutputVariable     = "SpecificPowerInWattsPerGram"
  numTimeSteps       = 2
  timeSteps          = 1, 10000.
  useFixedValue      = TRUE
  fixedValues        = 1.0, 2.0
  MemoryLocation = "managed"
}

DiffusionBVPOperator {
  name="LinearBVPOperator"
  MemoryLocation = "managed"
  print_info_level = 1
  VolumeOperator = "DiffusionLinearFEOperator1"
  BoundaryOperator = "ColumnBoundaryOperator1"
}

DiffusionLinearFEOperator1{
  name="DiffusionLinearFEOperator"
  FixedTemperature = TRUE
  FixedConcentration = TRUE
  FixedBurnup   = TRUE
  InputVariable = "therm"
  OutputVariable = "therm"
 
  DiffusionElement {
    name="DiffusionLinearElement"
    FE_ORDER = "FIRST"  
    FE_FAMILY = "LAGRANGE"
    QRULE_TYPE = "QGAUSS"
    QRULE_ORDER = "DEFAULT"
  }
  LocalModel = "DiffusionTransportModel1"
}

ColumnBoundaryOperator1 {
  name="ColumnBoundaryOperator"
  numberOfBoundaryOperators=2
  boundaryOperators="RobinBoundaryOperator","DirichletMatrixCorrection"
}

RobinBoundaryOperator {
  name="RobinMatrixCorrection"
  skip_params = FALSE
  FE_ORDER = "FIRST"  
  FE_FAMILY = "LAGRANGE"
  QRULE_TYPE = "QGAUSS"
  QRULE_ORDER = "DEFAULT"
  alpha          = 1.0
  beta           = 1.0
  gamma          = 1.0
  number_of_ids    = 1
  id_0             = 2
  number_of_dofs_0 =   1
  dof_0_0          =   0
  value_0_0        = 101.
}

DirichletMatrixCorrection{
  name="DirichletMatrixCorrection"
  skip_params = FALSE
  skip_rhs_correction = FALSE
  skip_rhs_add_correction = FALSE
  number_of_ids = 1
  id_0             = 1
  number_of_dofs_0 =   1
  dof_0_0          =   0
  value_0_0        = 300.
}

DiffusionTransportModel1 {
  name="DiffusionTransportModel"
  Material = "Independent"
  Property = "ThermalConductivity"
  Default_Concentration = .1
  Default_Temperature   = 300.
  Default_Burnup   = 0.0
}

VolumeIntegralOperator{
  name="VolumeIntegralOperator"
  MemoryLocation="managed"
  InputVariableType = "IntegrationPointScalar"
  Number_Active_Variables = 1
  Number_Auxillary_Variables = 0
  ConstantSource   = FALSE
  ActiveInputVariables{
    ActiveVariable_0 = "SpecificPowerInWattsPerGram" 
  }
  OutputVariable = "heatsource"
  LocalModel = "SourcePhysicsModel"
  SourceElement {
    name="SourceNonlinearElement"
    FE_ORDER = "FIRST"  
    FE_FAMILY = "LAGRANGE"
    QRULE_TYPE = "QGAUSS"
    QRULE_ORDER = "DEFAULT"
  }
}

SourcePhysicsModel {
  name = "SourcePhysicsModel"
  Material = "Independent"
  USE_ELEMENT_PHYSICS = "MassDensityModel"
  Equation = "ThermalSource"
  USE_MATERIALS_LIBRARY = TRUE 
}

LinearSolver{
  name = "BoomerAMGSolver"
  relative_tolerance = 1.0e-12
  absolute_tolerance = 1.0e-12
  max_levels             = 25
  max_coarse_size        = 16
  min_coarse_size        = 0
  max_iterations         = 100
  min_iterations         = 1
  measure_type           = 0
  coarsen_type           = 8
  P_max_elements         = 0
  interp_type            = 6
  separate_weights       = 0
  cgc_iterations         = 1
  cycle_type             = 1
  relax_order            = 0
  relax_type             = 6
  relax_weight           = 1.0
  outer_weight           = 1.0
  number_sweeps          = 1
  num_functions          = 1
  nodal                  = 0
  nodal_diag             = 0
  smooth_type            = 6
  smooth_number_levels   = 0
  smooth_number_sweeps   = 1
  schwarz_variant        = 0
  schwarz_overlap        = 1
  schwarz_domain_type    = 2
  schwarz_nonsymmetric   = 0
  schwarz_weight         = 1.0
  chebyshev_order        = 2
  chebyshev_fraction     = 0.3
  number_samples         = 0
  debug_flag             = 1
  additive_level         = -1
  mult_additive_level    = -1
  simple_level           = -1
  add_P_max_elmts        = 0
  rap2                   = 0
  keep_transpose         = 1
  strong_threshold       = 0.25
  max_row_sum            = 0.9
  trunc_factor           = 0.0
  agg_interp_type        = 5
  agg_P_max_elements     = 0
  agg_num_levels         = 5
  num_paths              = 1
  agg_trunc_factor       = 0.0
  agg_P12_trunc_factor   = 0.0
  agg_P12_max_elements   = 0
  non_galerkin_tol       = 0.05
  additive_trunc_factor  = 0.0
  logging                = 0
  print_info_level       = 2
}


