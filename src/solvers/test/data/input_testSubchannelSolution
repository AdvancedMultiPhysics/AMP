// Input file for testSubchannelSolution
Mesh {
     MeshName = "clad"
     MeshType = "AMP"
     dim = 3
     Generator = "cube"
     Size = 1, 1, 9
     Range = 0.0, 1.0, 0.0, 1.0, 0.0, 3.81 
     x_offset = 0.0
     y_offset = 0.0
     z_offset = 0.0
}

SubchannelTwoEqNonlinearOperator{
    name = "SubchannelTwoEqNonlinearOperator"
    InputVariable = "flow"
    OutputVariable = "flow"
    numpoints = 10
    Exit_Pressure = 15.5132e6
    Inlet_Temperature = 569.26
    Mass_Flow_Rate = 0.3522
    Fission_Heating_Coefficient = 0.0
    Channel_Angle = 0.0
    Friction_Factor = 0.1
    Lattice_Pitch = 0.0128016
    Rod_Diameter = 0.0097028
    Form_Loss_Coefficient = 0.2
    Rod_Power = 66.81e3
    Heat_Source_Type = "totalHeatGeneration"
    Channel_Diameter = 0.01178  // Todreas, p.455
    Reynolds         = 95432.91 // Todreas, p.456, based on viscosity=8.69e-5; velocity=1 m/s; density=704; & Channel_Diameter
    Prandtl          = 1.0      // Todreas, p.455, based on viscosity=8.69e-5; Conductivity; & Heat_Capacity 
    Heat_Shape = "Sinusoidal"
    LocalModel = "SubchannelPhysicsModel"
}

SubchannelTwoEqLinearOperator{
    name = "SubchannelTwoEqLinearOperator"
    InputVariable = "flow"
    OutputVariable = "flow"
    numpoints = 10
    Exit_Pressure = 15.5132e6
    Inlet_Temperature = 569.26
    Mass_Flow_Rate = 0.3522
    Fission_Heating_Coefficient = 0.0
    Channel_Angle = 0.0
    Friction_Factor = 0.1
    Lattice_Pitch = 0.0128016
    Rod_Diameter = 0.0097028
    Form_Loss_Coefficient = 0.2
    Rod_Power = 66.81e3
    Heat_Source_Type = "totalHeatGeneration"
    Channel_Diameter = 0.01178  // Todreas, p.455
    Reynolds         = 95432.91 // Todreas, p.456, based on viscosity=8.69e-5; velocity=1 m/s; density=704; & Channel_Diameter
    Prandtl          = 1.0      // Todreas, p.455, based on viscosity=8.69e-5; Conductivity; & Heat_Capacity 
    Heat_Shape = "Sinusoidal"
    LocalModel = "SubchannelPhysicsModel"
}

SubchannelPhysicsModel{
	name = "SubchannelPhysicsModel"
	Material = "WaterLibrary"
	Formulation = "FunctionsTesting"
	Defaults{
        diameter    = 0.01178  // Todreas, p.455
		temperature = 350.0
		enthalpy    = 200.0e3
		pressure    = 0.5e6
		density     = 973.919
        reynolds    = 95432.91 // Todreas, p.456, based on viscosity=8.69e-5; velocity=1 m/s; density=704; & Channel_Diameter
        prandtl     = 1.0      // Todreas, p.455, based on viscosity=8.69e-5; Conductivity; & Heat_Capacity 
	}
}

NonlinearSolver{
  print_info_level = 7
    max_iterations = 100
    max_error = 1e-10

    absoluteTolerance = 1.0e-9
    relativeTolerance = 1.0e-6
    stepTolerance = 1.0e-10
    maximumFunctionEvals = 100
    usesJacobian=FALSE

    SNESOptions = "-snes_monitor -snes_type ls -snes_converged_reason -snes_ksp_ew -snes_ksp_ew_version 1 -snes_ls_alpha 0.01"

    LinearSolver{
      print_info_level = 10
        max_iterations = 100
        max_error = 1e-10
        ksp_type = "fgmres"
        absolute_tolerance = 1.0e-9
        relative_tolerance = 1.0e-01
        divergence_tolerance = 1.0e03
        max_krylov_dimension = 40
        uses_preconditioner=FALSE
        pc_type = "none"
        pc_side = "RIGHT"

        KSPOptions = "-ksp_monitor -ksp_converged_reason -ksp_max_it 100"
        Preconditioner{
          print_info_level = 1
            max_iterations = 1
            max_error = 1.0e-15
        }
    }
}
