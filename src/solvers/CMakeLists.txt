BEGIN_PACKAGE_CONFIG( solvers )
ADD_PACKAGE_SUBDIRECTORY( testHelpers )
ADD_PACKAGE_SUBDIRECTORY( newFrozenVectorDesign )

# AMG solver package set apart from main solvers due to complexity
ADD_PACKAGE_SUBDIRECTORY( amg )
ADD_PACKAGE_SUBDIRECTORY( amg/default )

IF( USE_PETSC )
    ADD_PACKAGE_SUBDIRECTORY( petsc )
ENDIF()
IF ( USE_TRILINOS )
    ADD_PACKAGE_SUBDIRECTORY( trilinos )
    IF( USE_TRILINOS_ML )
        ADD_PACKAGE_SUBDIRECTORY( trilinos/ml )
    ENDIF()
    IF( USE_TRILINOS_NOX )
        ADD_PACKAGE_SUBDIRECTORY( trilinos/nox )
    ENDIF()
    IF( USE_TRILINOS_THYRA )
        ADD_PACKAGE_SUBDIRECTORY( trilinos/thyra )
    ENDIF()
    IF( USE_TRILINOS_MUELU )
        ADD_PACKAGE_SUBDIRECTORY( trilinos/muelu )
    ENDIF()
ENDIF()
IF( USE_LIBMESH AND ( USE_PETSC OR USE_TRILINOS ) )
    ADD_PACKAGE_SUBDIRECTORY( libmesh )
ENDIF()
IF( USE_HYPRE )
    ADD_PACKAGE_SUBDIRECTORY( hypre )
ENDIF()
INSTALL_AMP_TARGET( solvers )

IF ( USE_TRILINOS )
    SET_DEVICE_COMPILER( trilinos )
    IF( USE_TRILINOS_ML )
        SET_DEVICE_COMPILER( trilinos/ml )
    ENDIF()
    IF( USE_TRILINOS_NOX )
        SET_DEVICE_COMPILER( trilinos/nox )
    ENDIF()
    IF( USE_TRILINOS_THYRA )
        SET_DEVICE_COMPILER( trilinos/thyra )
    ENDIF()
    IF( USE_TRILINOS_MUELU )
        SET_DEVICE_COMPILER( trilinos/muelu )
    ENDIF()
ENDIF()

# Set the default matrix type
SET( MATRIX_TYPES "ManagedEpetraMatrix" "NativePetscMatrix" "CSRMatrix" "DenseSerialMatrix" "NULL" )
IF ( NOT DEFINED DEFAULT_MATRIX )
    SET( DEFAULT_MATRIX "CSRMatrix" )
ENDIF()
IF ( NOT "${DEFAULT_MATRIX}" IN_LIST MATRIX_TYPES )
    MESSAGE( FATAL_ERROR "DEFAULT_MATRIX=${DEFAULT_MATRIX} is not a valid matrix type" )
ENDIF()
IF ( "${DEFAULT_MATRIX}" STREQUAL "ManagedEpetraMatrix" AND NOT USE_TRILINOS )
    MESSAGE( FATAL_ERROR "Specified default matrix of ManagedEpetraMatrix, but compiled without Trilinos" )
ENDIF()
IF ( "${DEFAULT_MATRIX}" STREQUAL "NativePetscMatrix" AND NOT USE_PETSC )
    MESSAGE( FATAL_ERROR "Specified default matrix of NativePetscMatrix, but compiled without PETSc" )
ENDIF()
ADD_COMPILE_DEFINITIONS( DEFAULT_MATRIX="${DEFAULT_MATRIX}" )

ADD_SUBDIRECTORY( test )


